name: Guardrails

on:
  push:
  pull_request:

jobs:
  middleware-proxy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Ensure we don't ship both middleware.ts and proxy.ts
        run: |
          if [ -f "./middleware.ts" ] && [ -f "./proxy.ts" ]; then
            echo "ERROR: Both middleware.ts and proxy.ts exist. Keep only proxy.ts."
            exit 1
          fi
          echo "OK"
